# Программа для создания комплекта документов на основе шаблонов

Программа предназначена для создания комплекта документов на допуск ремонтного персонала к ремонту дуговой сталеплавильной печи.
### Технологии
- Python 3.7.9
- JS
- HTML
- CSS
- ООП
- Eel
- docxtpl
- peewee
- pandas
- configparser

## Краткое описание работы программы

Программа разработана для работы в ОС Windows с установленным браузером Google Chrome. 

Имена работников, участвующих в оформлении наряда-допуска, а также их возможные роли, перечислены в таблице MS Excell. Данные из файла MS Excel  считываются в объект DataFrame  библиотеки pandas. На основе данных DataFrame, с помощью peewee  ORM  создается база данных sqlite, с которой, в последствии и ведется работа (модуль 'create_db.py'). Модель таблицы БД описана в файле 'model.py'.

Графический интерфейс реализован с помощью библиотеки eel. Файлы интерфейса (HTML, CSS и JS-скрипты) находятся в папке 'wui'. Списки имен передаются в JS-скрипт, который формирует элементы интерфейса – формы с выпадающими списками.

После нажатия кнопки 'Создать пакет НД' происходит верификация введенных данных (выбранные имена не должны совпадать), и, если проверка прошла успешно, начинается генерация документов на основе шаблонов.

Для генерации готового документа на основе заранее размеченного шаблона, используются методы класса DocxTemplate из библиотеки docxtpl.

Основные настройки программы – имя файла таблицы Excel, имя файла БД, имя папки с шаблонами, имя папки с готовыми документами и т.д., хранятся в файле settings.ini (для работы с ним использована библиотека configparser).

Дополнительные поля, указанные в файле 'extra_keys.txt', добавляются к основному словарю.


## Как работать с программой

1. Клонировать репозиторий:

```git clone https://github.com/iurij-n/MakeND.git```

2. Установить зависимости:

```pip install –r requirements.txt```

3. Создать и активировать виртуальное окружение:

```python –m venv venv```

```source venv/Scripts/activate```

4. В файле MS Excell с именем 'itr_list.xlsx' перечислить ФИО инженерно-технических работников, участвующих в оформлении наряда-допуска и указать их роли (любой символ в нужном столбце напротив имени).

5. В папке 'templates' разместить шаблоны документов в формате MS  Word. В нужных местах шаблона необходимо поставить ключи вида {{ ИмяКлюча }}. В процессе генерации итогового документа ключи будут заменены на их значения.

Доступные ключи:
- {{ ДСП }} - номер ремонтируемого агрегата;
- {{ Ряды }} - буквенное обозначение рядов колонн цеха;
- {{ Дата }} - дата проведения ремонта;
- {{ СписокДопускающих }} - список лиц которые могут быть допускающими к выполнению работ повышенной опасности;
- {{ Допускающий }} - фамилия и инициалы допускающего к работе по наряду-допуску;
- {{ Выдающий }} - ФИО выдавшего наряд-допуск;
- {{ Согласующий }} - ФИО лица согласующего наряд-допуск.

В файле 'extra_keys.txt' можно добавить любые другие ключи в формате:

```ИмяКлюча: замещающий текст```

Например:

```Исполнитель: ООО Строитель```

После этого будет доступен ключ {{ Исполнитель }}.


6. Выполнить команду:

```python make_nd.py```

7. После запуска графического интерфейса указать номер ремонтируемого агрегата, дату ремонта, из выпадающих списков выбрать имена допускающего, выдающего и согласующего наряд-допуск. Нажать кнопку 'Создать пакет НД'. Процесс создания комплекта документов отображается в интерфейсе и в окне терминала.

8. Папка с готовыми НД откроется автоматически.
